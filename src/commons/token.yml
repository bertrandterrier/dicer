_meta:
  description: >-
    Token types for the Dicer lexer/parser.

    !! Ignore all fields starting with '_' !!

    - nesting:
      "tokens" -> list of dictionary carrying list of dictionaries.
      The file is nested in two levels. Just iterate threw fields that have a nested
      dictionary and extract this to flatten.
  fields:
    id: >-
      NON-OPTIONAL
      integer or floating point number
    name: >-
      NON-OPTIONAL
      string
      Token type name
    descr: >-
      NON-OPTIONAL
      multi-line string
      short helper description
    symbol: >-
      string
      the element, sometimes only delimiter symbol.
    symbols: >-
      list of strings
      alternative to /symbol/ -- provides synonyms
    regex: >-
      literal string
      regular expression (SRE)
    regexes: >-
      list of literal strings
      alternative to /regex/, if multiple expressions are needed.
    subtypes: >-
      map
      if more exhaustive information has to be provided.
    subtype_fields:
      name: >-
        string
        identifying name for subtype
      regex: Like /regex/
      types: >-
        list of strings or /false/
        expected return types for groups in regex. /false/ marks an unexpected/false match.
      quantity: >-
        integer
        number of groups that will be returned.
      idents: >-
        list of strings
        identifier names for returned groups, in order

  author: bertrandterrier
  lang: Dicer
  created: 2025-11-14
  updated: 2025-11-14
tokens:
  run_modes:
    - id: 1
      name: "DEBUG"
      descr: Show all errors, warnings, and messages.
    - id: 1
      name: "VERBOSE"
      descr: Show all warnings, errors, and messages not specifically marked DEBUG (0)
    - id: 2
      name: "USER"
      descr: Show only warnings and errors.
    - id: 3
      name: "MINIMAL"
      descr: Suppress all messages and warnings, not errors.
    - id: 4
      name: "SILENT"
      descr: Suppress all messges if not critical errors.
  basic:
    - id: 10
      name: "EOF"
      descr: "End of File"
    - id: 11
      name: "EOE"
      descr: "End of Expression"
    - id: 12
      name: "EOP"
      descr: "End of Process"
  errors:
    - id: 20
      name: "ERROR"
      descr: Basic Error. To catch non-processables
    - id: 21
      name: "SYNTAX ERROR"
    - id: 22
      name: "TYPE ERROR"
      descr: Invalid type.
    - id: 23
      name: "CALL ERROR"
      descr: Child process error.
      subtypes:
        - Shell process error.
  warnings:
    - id: 30
      name: "WARNING"
      descr: Indeterminate warning.
  delimiter:
    - id: 1000
      name: "lpar"
      descr: left parenthesis
      symbol: "("
      regex: ''
    - id: 1001
      name: "rpar"
      descr: right parenthesis
      symbol: ")"
      regex: \'
    - id: 1002
      name: "rbrack"
      descr: right square bracket
      symbol: "]"
      regex: '\]'
    - id: 1003
      symbol: "["
      descr: "left square bracket"
      regex: '\['
    - id: 1004
      descr: "right curly bracket"
      symbol: "}"
      regex: '\}'
    - id: 1005
      name: "lbrace"
      descr: left curly bracket
      symbol: "{"
      regex: '\{'
    - id: 1006
      name: "lmath"
      descr: "left math angle bracket"
      symbol: "⟨"
      regex: '⟨'
    - id: 1007
      name: "rmath"
      descr: right math angle bracket
      symbol: "⟩" 
      regex: '⟩'
    - id: 1008
      name: "squote"
      descr: single quotation mark
      symbol: "'"
      regex: "'"
    - id: 1009
      name: "dquote"
      descr: double quotation mark
      symbol: '"'
      regex: '"'
    - id: 1010
      name: "sep"
      descr: element seperator symbols space or semicolon
      symbols: [",", " "]
      regex: '[,\s]'
    - id: 1011
      name: "term"
      descr: line terminator -- newline or double semicolon
      symbols: ['\n', ";"]
      regexes: ['\n', ';']
    - id: 1012
      name: "lmlcmt"
      descr: left multi-line comment delimiter
      symbol: "~~>" 
      regex: '~{2}>'
    - id: 1013
      name: "rmlcmt"
      descr: right multi-line comment delimiter
      symbol: '<~~'
      regex: '<~{2}'
    - id: 1014
      name: "lilcmt"
      descr: left in-line comment
      symbol: "~>"
      regex: '~>'
    - id: 1015
      name: "rilcmt"
      descr: right in-line comment
      symbol: "<~"
      regex: '<~'
    - id: 1016
      name: "lellrule"
      descr: element-limited local rule, left delim
      symbol: "<<-"
      regex: '<{2}-'
    - id: 1017
      name: "rellrule"
      descr: element-limited local rule, right delim
      symbol: ">>-"
      regex: '>{2}-'
    - id: 1018
      name: "lgrule"
      descr: global rule, left delim
      symbol: "<=<"
      regex: '<=<'
    - id: 1019
      name: "rgrule"
      descr: global rule, right delim
      symbol: ">=>"
      regex: '>=>'
  trigger:
    - id: 1100
      name: "exmark"
      descr: Exclamation mark -- NEGATION 
      symbol: "!"
      regex: '!'
    - id: 1101
      name: "qmark"
      descr: Questin mark -- QUERY
      symbol: "?"
      regex: '\?'
    - id: 1102
      name: "hash"
      descr: number sign -- TAG NAME 
      symbol: "#"
      regex: '#'
    - id: 1103
      name: "peso"
      descr: Peso/dollar -- REFERENCE
      symbol: "$"
      regex: '\$'
    - id: 1104
      name: "at"
      descr: Unbound attribute reference
      symbol: "@"
      regex: '@'
    - id: 1105
      name: "amp"
      descr: Walk procedure -- EVALUATING
      symbol: "&"
      regex: '&'
    - id: 1106
      name: "ddef"
      descr: Colon + Equal Sign -- NAMING
      symbol: ":="
      regex: ':='
    - id: 1107
      name: dcolon
      descr: double colon -- ATTRIBUTE SETTING
      symbol: "::"
      regex: ':{2}'
  connectives:
    - id: 1200
      name: "dot"
      descr: period -- CONCATENATION "AND"
      symbol: "."
      regex: '\.'
    - id: 1201
      name: "bar"
      descr: Pipe bar -- PIPE
      symbol: "|"
      regex: '\|'
    - id: 1202
      name: "dbar"
      descr: Double pipe bar -- ALTERNATION "OR (exclusive)"
      symbol: "||"
      regex: '\|{2}'
    - id: 1203
      name: "top"
      descr: Top limiter
      symbol: "^"
      regex: '\^'
    - id: 1204
      name: "uscore"
      descr: Bottom limiter
      symbol: "_"
      regex: '_'
  operators:
    - id: 1400
      name: "plus"
      descr: Addition or context concatenation procedure
      symbol: "+"
      regex: '\+'
    - id: 1401
      name: "dash"
      descr: Subtraction or negative concatenation procedure
      symbol: "-"
      regex: '-'
    - id: 1402
      name: "star"
      descr: Multiplication
      symbol: "*"
      regex: '\*'
    - id: 1403
      name: "slash"
      descr: Division or negative modification procedure
      symbol: "/"
      regex: '/'
    - id: 1404
      name: "dslash.uscore"
      descr: floor operation
      symbol: "/_"
      regex: '/_'
    - id: 1405
      name: "dslash.top"
      descr: roof operation
      symbol: "/^"
      regex: '/^'
    - id: 1406
      name: "gt"
      descr: Greater than
      symbol: ">"
      regex: '>'
    - id: 1407
      name: "gte"
      descr: Greater than or equal
      symbol: ">="
      regex: '>='
    - id: 1408
      name: "lt"
      descr: Lower than
      symbol: "<"
      regex: '<'
    - id: 1409
      name: "lte"
      descr: Smaller than or equal
      symbol: "<="
      regex: '<='
  command_keywords:
    - id: 1500
      name: "dice"
      descr: Dice command
      symbols: ["dice", "d", "D", "DICE"]
      regexes: ['[dD]', '[dD][iI][cC][eE]']
    - id: 1501
      name: "query"
      descr: Query
      symbols: ["q", "query", "Q", "Query", "QUERY"]
      regexes: ['[qQ]', '[qQ][uU][eE][rR][yY]']
      methods:
        - id: 1501.1
          name: "find"
          descr: Returns 
    - id: 1502
      name: "calc"
      descr: Calculation command
      symbols: []
    - id: 1503
      name: "count"
      descr: "Count command"
      symbols: ["c", "count", "C", "Count", "COUNT"] 
      regexes: ['c', '[cC][oO][uU][nN][tT]']
    - id: 1504
      name: "sh"
      descr: Shell command
      symbols: ["sh", "SH", "Sh", "Shell", "SHELL"]
      regexes: ['[sS][hH]', '[sS][hH][eE][lL]{2}']
    - id: 1505
      name: "pcall"
      descr: Protected call
      symbols: ["try", "Try", "TRY", "p", "P"]
      regexes: ['[pP]', '[tT]', '[tT][rR][yY]']
    - id: 1506
      name: "if"
      descr: Condition Command
      symbols: ["if", "If", "IF"]
      regex: '[iI][fF]'
    - id: 1507
      name: while
      descr: Condition loop
      symbols: ["wh", "Wh", "WH","while", "While", "WHILE"]
      regexes: ['[wW][hH]', '[wW][hH][iI][lL][eE]']
  constructors:
    - id: 1600
      name: "rspec"
      descr: Range Specification
      subtypes:
        - name: "range_max"
          regex: '\d+'
          quantity: 1
          idents: ["max"]
          types: ["integer"]
        - name: "range"
          regex: '([\-\+]{0,1}\d*):([\-\+]{0,1}\d*):([\-\+]{0,1}\d+)'
          quantity: 3
          idents: ["min", "steps", "max"]
          defaults: [1, 1, false]
          types:
            - ["null", "integer"]
            - ["null", "integer"]
            - "integer"
    - id: 1600
      name: "odds"
      descr: Odds Specification
      subtypes:
        - name: "binary"
          regex: '([1-9][0-9]*)\.{0,1}([1-9]*)\|([1-9][0-9]*)\.{0,1}(\d*)'
          quantity: 4
          idents: ["win", "critical_win", "loss", "critical_loss"]
          types: ["integer", "integer|null", "integer", "integer|null"]
          defaults: [false, 0, false, 0]
        - name: "tenary"
          regex: '([1-9][0-9]+)\.{0,1}([0-9]*)\|([1-9][0-9]+)\.([0-9]+)\|([1-9][0-9]+)'
          idents: ["win", "critical_win", "loss", "critical_loss", "neutral"]
          types: ["integer", "integer|null", "integer", "integer|null", "integer"]
          defaults: [false, 1, false, 1, false]
    - id: 1601
      name: "chance"
      descr: Chance percentage
      regex: '(\d{0,2}[1-9])%'
  special_constructs:
    - id: 1700
      name: omult
      descr: object multiplicator
      subtypes:
        - name: number
          regex: '([1-9]\d*)[xX]'
          idents: ["value"]
          quantity: 1
          types: ["integer"]
          defaults: [false]
        - name: fraction
          regex: '([0-9]{0,1})\.(\d+)x'
          idents: ["integer", "decimals"]
          quantity: 2
          defaults: [0, false]
